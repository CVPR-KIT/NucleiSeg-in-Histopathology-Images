PreRun: Creating required directories
Directory Outputs/ already exists
Directory log/ already exists
PreRun: generating experiment config file
Using cuda device
configuring data loaders
loading Images from path: Dataset/trainNormal2/


















































































































100%|██████████| 63360/63360 [03:51<00:00, 273.79it/s]
Using cache found in /home/blue/.cache/torch/hub/facebookresearch_dinov2_main
Loading Features
Applying DBSCAN
Unique clusters: [-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37]
Directory Outputs/Plots/ already exists
Sampling Initialization Complete
configuring model - UNET 3+
saving model summary
logging parameters
starting training
mode: train
Epoch 0/30:   0%|          | 0/52 [00:00<?, ?it/s]
Plotting Batches for visualization
Directory Outputs/Batch_Plots/ already exists


















































































































































































































































































































































































































































































Epoch 0/30: : 819it [20:44,  1.11s/it]
train_loss: 6.6891888827085495
train_mIoU: 0.49408615288766067
Epoch 0/30: : 820it [20:45,  1.52s/it]
Epoch 0/30:   0%|          | 0/9600 [00:00<?, ?it/s]
























































































































Epoch 0/30: 100%|█████████▉| 9599/9600 [04:01<00:00, 39.82it/s]
Traceback (most recent call last):
  File "/home/blue/projects/MoNuSeg/main.py", line 641, in <module>
    main()
  File "/home/blue/projects/MoNuSeg/main.py", line 466, in main
    val_loss, val_confusion_matrix,val_mIoU,val_accuracy = run_epoch(model, val_data, criterion, optimizer, epoch, device, 'val',config)
  File "/home/blue/projects/MoNuSeg/main.py", line 127, in run_epoch
    for idx,(images,label) in enumerate(pgbar):
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
UnboundLocalError: Caught UnboundLocalError in DataLoader worker process 3.
Original Traceback (most recent call last):
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/blue/projects/MoNuSeg/monuSegEnv/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/blue/projects/MoNuSeg/dataset.py", line 135, in __getitem__
    self.wid = image.shape[0]
UnboundLocalError: local variable 'image' referenced before assignment